# Используем официальный образ Python 3.9 на основе slim
FROM python:3.9-slim

# Устанавливаем рабочую директорию внутри контейнера
WORKDIR /app

# Копируем текущую директорию (где находится Dockerfile) в /app внутри контейнера
COPY . /app

# Устанавливаем локаль
ENV LANG=C.UTF-8

# Создаём непривилегированного пользователя для повышения безопасности
RUN useradd -m ctfuser && chown -R ctfuser /app

# Переключаемся на нового пользователя
USER ctfuser

# Указываем, что контейнер будет слушать на порту 11111
EXPOSE 11111

# Определяем переменную окружения для флага (можно переопределить при запуске)
ENV FLAG="limeCTF{1t_15_hard_t0_b3_a_5py}"

# Запускаем сервер при старте контейнера
CMD ["python", "server.py"]
